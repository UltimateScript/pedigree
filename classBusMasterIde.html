<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>The Pedigree Project: BusMasterIde Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Pedigree Project
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classBusMasterIde-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">BusMasterIde Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for BusMasterIde:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBusMasterIde__coll__graph.png" border="0" usemap="#BusMasterIde_coll__map" alt="Collaboration graph"/></div>
<map name="BusMasterIde_coll__map" id="BusMasterIde_coll__map">
<area shape="rect" id="node2" href="classIoBase.html" title="Abstrace base class for hardware I/O capabilities. " alt="" coords="501,2414,639,2741"/>
<area shape="rect" id="node3" href="classMemoryRegion.html" title="Special memory entity in the kernel&#39;s virtual address space. " alt="" coords="663,2392,839,2763"/>
<area shape="rect" id="node4" href="classMutex.html" title="{Mutex\n||+ Mutex()\l+ ~Mutex()\l}" alt="" coords="888,2531,975,2623"/>
<area shape="rect" id="node5" href="classSemaphore.html" title="{Semaphore\n|&#45; magic\l&#45; m_bCanInterrupt\l|+ Semaphore()\l+ ~Semaphore()\l+ acquireWithResult()\l+ acquire()\l+ tryAcquire()\l+ release()\l+ getValue()\l&#45; Semaphore()\l&#45; operator=()\l&#45; removeThread()\l}" alt="" coords="857,2119,1006,2343"/>
<area shape="rect" id="node6" href="classSpinlock.html" title="{Spinlock\n|+ allow_recursion\l&#45; m_bInterrupts\l&#45; m_Sentinel\l&#45; m_Magic\l&#45; m_MagicAlign\l&#45; m_pOwner\l&#45; m_Level\l&#45; m_OwnedProcessor\l&#45; m_Ra\l&#45; m_bAvoidTracking\l&#45; m_bOwned\l|+ Spinlock()\l+ Spinlock()\l+ acquire()\l+ exit()\l+ release()\l+ acquired()\l+ interrupts()\l&#45; unwind()\l&#45; trackRelease()\l}" alt="" coords="743,553,891,895"/>
<area shape="rect" id="node13" href="classObjectPool.html" title="{ObjectPool\&lt; _ListNode\l_t, 16 \&gt;\n||+ ObjectPool()\l+ ~ObjectPool()\l+ allocate()\l+ deallocate()\l}" alt="" coords="554,1317,711,1453"/>
<area shape="rect" id="node17" href="classObjectPool.html" title="{ObjectPool\&lt; T, poolSize \&gt;\n||+ ObjectPool()\l+ ~ObjectPool()\l+ allocate()\l+ deallocate()\l}" alt="" coords="381,1038,557,1159"/>
<area shape="rect" id="node20" href="classObjectPool.html" title="{ObjectPool\&lt; _ListNode\l_t, nodePoolSize \&gt;\n||+ ObjectPool()\l+ ~ObjectPool()\l+ allocate()\l+ deallocate()\l}" alt="" coords="262,1317,419,1453"/>
<area shape="rect" id="node7" href="classAtomic.html" title="{Atomic\&lt; uint64_t \&gt;\n||}" alt="" coords="750,248,883,325"/>
<area shape="rect" id="node8" href="classAtomic.html" title="{Atomic\&lt; T, bAllow \&gt;\n||}" alt="" coords="892,5,1035,83"/>
<area shape="rect" id="node9" href="classAtomic.html" title="{Atomic\&lt; bool \&gt;\n||}" alt="" coords="908,248,1019,325"/>
<area shape="rect" id="node10" href="classAtomic.html" title="{Atomic\&lt; ssize_t \&gt;\n||}" alt="" coords="995,452,1124,529"/>
<area shape="rect" id="node11" href="classList.html" title="{List\&lt; class Thread * \&gt;\n|&#45; m_Count\l&#45; m_Magic\l|+ List()\l+ List()\l+ ~List()\l+ operator=()\l+ size()\l+ count()\l+ pushBack()\l+ pushBack()\l+ popBack()\l+ pushFront()\land 14 more...\l}" alt="" coords="432,1817,583,2056"/>
<area shape="rect" id="node12" href="struct__ListNode__t.html" title="One node in the list. " alt="" coords="5,678,129,770"/>
<area shape="rect" id="node14" href="classVector.html" title="{Vector\&lt; _ListNode_t * \&gt;\n|&#45; m_Size\l&#45; m_Count\l&#45; m_Start\l&#45; m_ReserveFactor\l|+ Vector()\l+ Vector()\l+ Vector()\l+ ~Vector()\l+ operator=()\l+ operator[]()\l+ size()\l+ count()\l+ pushBack()\l+ popBack()\land 19 more...\l&#45; reserve()\l}" alt="" coords="194,957,357,1240"/>
<area shape="rect" id="node19" href="classList.html" title="{List\&lt; T, nodePoolSize \&gt;\n|&#45; m_Count\l&#45; m_Magic\l|+ List()\l+ List()\l+ ~List()\l+ operator=()\l+ size()\l+ count()\l+ pushBack()\l+ pushBack()\l+ popBack()\l+ pushFront()\land 14 more...\l}" alt="" coords="259,1516,422,1755"/>
<area shape="rect" id="node15" href="classVector.html" title="A vector / dynamic array. " alt="" coords="325,145,460,428"/>
<area shape="rect" id="node18" href="classVector.html" title="{Vector\&lt; T * \&gt;\n|&#45; m_Size\l&#45; m_Count\l&#45; m_Start\l&#45; m_ReserveFactor\l|+ Vector()\l+ Vector()\l+ Vector()\l+ ~Vector()\l+ operator=()\l+ operator[]()\l+ size()\l+ count()\l+ pushBack()\l+ popBack()\land 19 more...\l&#45; reserve()\l}" alt="" coords="412,583,547,865"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8e60e26858013365de9b0bba6bbe7284"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a8e60e26858013365de9b0bba6bbe7284">initialise</a> (<a class="el" href="classIoBase.html">IoBase</a> *pBase)</td></tr>
<tr class="memdesc:a8e60e26858013365de9b0bba6bbe7284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises DMA for a specific channel.  <a href="#a8e60e26858013365de9b0bba6bbe7284">More...</a><br /></td></tr>
<tr class="separator:a8e60e26858013365de9b0bba6bbe7284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef48369b4012c093137a685e7139df9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a3ef48369b4012c093137a685e7139df9">add</a> (uintptr_t buffer, size_t nBytes)</td></tr>
<tr class="memdesc:a3ef48369b4012c093137a685e7139df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a buffer to a DMA transaction.  <a href="#a3ef48369b4012c093137a685e7139df9">More...</a><br /></td></tr>
<tr class="separator:a3ef48369b4012c093137a685e7139df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc83797e4688ac4ec04ed2c14161f6d4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#abc83797e4688ac4ec04ed2c14161f6d4">begin</a> (bool bWrite)</td></tr>
<tr class="memdesc:abc83797e4688ac4ec04ed2c14161f6d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin a DMA operation.  <a href="#abc83797e4688ac4ec04ed2c14161f6d4">More...</a><br /></td></tr>
<tr class="separator:abc83797e4688ac4ec04ed2c14161f6d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0cfd093c2abe2e51a8a0ffa8cb4eb22"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#aa0cfd093c2abe2e51a8a0ffa8cb4eb22">hasInterrupt</a> ()</td></tr>
<tr class="memdesc:aa0cfd093c2abe2e51a8a0ffa8cb4eb22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if an INTERRUPT has occurred on this channel.  <a href="#aa0cfd093c2abe2e51a8a0ffa8cb4eb22">More...</a><br /></td></tr>
<tr class="separator:aa0cfd093c2abe2e51a8a0ffa8cb4eb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f35c7ea1071fc2d1b42ae22e2e8a313"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a3f35c7ea1071fc2d1b42ae22e2e8a313">hasError</a> ()</td></tr>
<tr class="memdesc:a3f35c7ea1071fc2d1b42ae22e2e8a313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if an ERROR has occurred on this channel.  <a href="#a3f35c7ea1071fc2d1b42ae22e2e8a313">More...</a><br /></td></tr>
<tr class="separator:a3f35c7ea1071fc2d1b42ae22e2e8a313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65fa5ed1cd22a02d8c5065cd957e60fb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a65fa5ed1cd22a02d8c5065cd957e60fb">hasCompleted</a> ()</td></tr>
<tr class="memdesc:a65fa5ed1cd22a02d8c5065cd957e60fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if the CURRENT TRANSFER has completed.  <a href="#a65fa5ed1cd22a02d8c5065cd957e60fb">More...</a><br /></td></tr>
<tr class="separator:a65fa5ed1cd22a02d8c5065cd957e60fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8430cd9cf2bfe8d67f4ff09544005e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a9c8430cd9cf2bfe8d67f4ff09544005e">commandComplete</a> ()</td></tr>
<tr class="memdesc:a9c8430cd9cf2bfe8d67f4ff09544005e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by drivers when a command completes.  <a href="#a9c8430cd9cf2bfe8d67f4ff09544005e">More...</a><br /></td></tr>
<tr class="separator:a9c8430cd9cf2bfe8d67f4ff09544005e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0573a028bf3e88608ea1b74af05d82"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#aca0573a028bf3e88608ea1b74af05d82">isActive</a> () const </td></tr>
<tr class="memdesc:aca0573a028bf3e88608ea1b74af05d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is there currently a DMA transaction taking place?  <a href="#aca0573a028bf3e88608ea1b74af05d82">More...</a><br /></td></tr>
<tr class="separator:aca0573a028bf3e88608ea1b74af05d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a43a87c1eb615fa3b5f7fc9610893558e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a43a87c1eb615fa3b5f7fc9610893558e">BusMasterIdeRegs</a> { <br />
&#160;&#160;<b>Command</b> = 0, 
<b>DeviceSpecific1</b> = 1, 
<b>Status</b> = 2, 
<b>DeviceSpecific2</b> = 3, 
<br />
&#160;&#160;<b>PrdTableAddr</b> = 4
<br />
 }</td></tr>
<tr class="separator:a43a87c1eb615fa3b5f7fc9610893558e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a64281433ea7409513cb8bfbeb57bde2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIoBase.html">IoBase</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a64281433ea7409513cb8bfbeb57bde2e">m_pBase</a></td></tr>
<tr class="separator:a64281433ea7409513cb8bfbeb57bde2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f6ae84963e5d3b46c536198a4b3bb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#aa5f6ae84963e5d3b46c536198a4b3bb3">m_PrdTableLock</a></td></tr>
<tr class="separator:aa5f6ae84963e5d3b46c536198a4b3bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd20e1a00214d0882733b710cec37a3b"><td class="memItemLeft" align="right" valign="top">PhysicalRegionDescriptor *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#afd20e1a00214d0882733b710cec37a3b">m_PrdTable</a></td></tr>
<tr class="separator:afd20e1a00214d0882733b710cec37a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43863c198347ec4eeb593c477695112a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a43863c198347ec4eeb593c477695112a">m_LastPrdTableOffset</a></td></tr>
<tr class="separator:a43863c198347ec4eeb593c477695112a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1279a7c02c9ab63cd54d5e462c426e8"><td class="memItemLeft" align="right" valign="top">physical_uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#ac1279a7c02c9ab63cd54d5e462c426e8">m_PrdTablePhys</a></td></tr>
<tr class="separator:ac1279a7c02c9ab63cd54d5e462c426e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf29f57c538991abac88e2fb9b381120"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemoryRegion.html">MemoryRegion</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#aaf29f57c538991abac88e2fb9b381120">m_PrdTableMemRegion</a></td></tr>
<tr class="separator:aaf29f57c538991abac88e2fb9b381120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6375cf97db78fcae0359c9bd7974ce14"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBusMasterIde.html#a6375cf97db78fcae0359c9bd7974ce14">m_bActive</a></td></tr>
<tr class="separator:a6375cf97db78fcae0359c9bd7974ce14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66beb8bc72d14bf723627f4ab5e4bb1f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66beb8bc72d14bf723627f4ab5e4bb1f"></a>
enum <a class="el" href="classBusMasterIde.html#a43a87c1eb615fa3b5f7fc9610893558e">BusMasterIde::BusMasterIdeRegs</a>&#160;</td><td class="memItemRight" valign="bottom"><b>__attribute__</b></td></tr>
<tr class="separator:a66beb8bc72d14bf723627f4ab5e4bb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generic <a class="el" href="classBus.html">Bus</a> Master IDE object. Given to devices that can use DMA by their controller, this class provides a set of routines for setting up and completing DMA transactions in conjunction with other devices on the same channel. The idea is to hide away as much of the gritty implementation of IDE DMA so that drivers have a clean and easy interface to use when performing DMA operations. This should also reduce code duplication. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00095">95</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a43a87c1eb615fa3b5f7fc9610893558e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classBusMasterIde.html#a43a87c1eb615fa3b5f7fc9610893558e">BusMasterIde::BusMasterIdeRegs</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Register layout </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00220">220</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3ef48369b4012c093137a685e7139df9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::add </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nBytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a buffer to a DMA transaction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Address of the buffer to be used for the transaction </td></tr>
    <tr><td class="paramname">nBytes</td><td>Size of the buffer </td></tr>
    <tr><td class="paramname">bWrite</td><td>Whether or not this is a write operation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if setting up the transaction is successful, false otherwise.</dd></dl>
<p>This will add a buffer to an existing transaction, or begin a new one if no transaction already exists. Calling  will remove all pending buffer (as they are complete). </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>Can't write if a read is in progress, and vice versa </dd></dl>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00086">86</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

<p>References <a class="el" href="Log_8h_source.html#l00082">ERROR</a>, <a class="el" href="Log_8h_source.html#l00089">FATAL</a>, <a class="el" href="classVirtualAddressSpace.html#a4c099087b6db046a7a72b0481d4b2827">VirtualAddressSpace::getMapping()</a>, <a class="el" href="Log_8h_source.html#l00136">Hex</a>, <a class="el" href="Processor_8cc_source.html#l00045">Processor::information()</a>, and <a class="el" href="classVirtualAddressSpace.html#a780a4f6593071c4fe0afe3d86762b263">VirtualAddressSpace::isMapped()</a>.</p>

</div>
</div>
<a class="anchor" id="abc83797e4688ac4ec04ed2c14161f6d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::begin </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bWrite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begin a DMA operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bWrite</td><td>Whether or not this is a write operation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if beginning the transaction is successful, false otherwise.</dd></dl>
<p>Driver code calls this to begin an operation. This call will store the buffer, and will begin the <a class="el" href="classBus.html">Bus</a> Master operation if it is not already in progress. For every buffer, device driver software should send a command to the respective device. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00192">192</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

<p>References <a class="el" href="Log_8h_source.html#l00089">FATAL</a>, and <a class="el" href="Log_8h_source.html#l00078">WARNING</a>.</p>

</div>
</div>
<a class="anchor" id="a9c8430cd9cf2bfe8d67f4ff09544005e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BusMasterIde::commandComplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called by drivers when a command completes. </p>
<p>The interface requires that we reset the command register's start bit upon command completion or failure. However, we don't want to do that in hasInterrupt or hasError because that may leave the interface in an unknown state. This function allows driver code to reset this bit at a convenient time.</p>
<dl class="section note"><dt>Note</dt><dd>This effectively resets the interface. That means the return values from hasInterrupt and hasError will both be invalid after calling this function. </dd></dl>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00257">257</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

<p>References <a class="el" href="Log_8h_source.html#l00074">NOTICE</a>.</p>

<p>Referenced by <a class="el" href="PciAtaController_8cc_source.html#l00390">PciAtaController::irq()</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBusMasterIde_a9c8430cd9cf2bfe8d67f4ff09544005e_icgraph.png" border="0" usemap="#classBusMasterIde_a9c8430cd9cf2bfe8d67f4ff09544005e_icgraph" alt=""/></div>
<map name="classBusMasterIde_a9c8430cd9cf2bfe8d67f4ff09544005e_icgraph" id="classBusMasterIde_a9c8430cd9cf2bfe8d67f4ff09544005e_icgraph">
<area shape="rect" id="node2" href="classPciAtaController.html#ab8e5bcf18c8f248b9ff9eb298a22add6" title="PciAtaController::irq" alt="" coords="277,42,416,69"/>
<area shape="rect" id="node3" href="classPciAtaController.html#a4ecebbc1ccbe372364d5931c892229d2" title="PciAtaController::PciAta\lController" alt="" coords="464,5,628,47"/>
<area shape="rect" id="node4" href="classPciAtaController.html#a4da01de55ebe791ef17246472620ec7e" title="PciAtaController::getName" alt="" coords="676,42,855,69"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a65fa5ed1cd22a02d8c5065cd957e60fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::hasCompleted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if the CURRENT TRANSFER has completed. </p>
<dl class="section return"><dt>Returns</dt><dd>True if the transfer has completed, false otherwise.</dd></dl>
<p>Some bus mastering controllers don't provide an IRQ line and others may need this particular function to be waited upon to be sure that the transfer has completed even if an IRQ is fired. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00246">246</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3f35c7ea1071fc2d1b42ae22e2e8a313"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::hasError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if an ERROR has occurred on this channel. </p>
<dl class="section return"><dt>Returns</dt><dd>True if an error has occurred, false otherwise.</dd></dl>
<p>If the interrupt status has been raised, it is imperative for driver software to check if an error occurred in their transfer. The specific error can be obtained through a device-specific method; this merely provides notification that the transfer failed </p>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00235">235</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aa0cfd093c2abe2e51a8a0ffa8cb4eb22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::hasInterrupt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if an INTERRUPT has occurred on this channel. </p>
<dl class="section return"><dt>Returns</dt><dd>True if an interrupt has occurred, false otherwise.</dd></dl>
<p>When writing driver code that uses a DMA transaction, waiting on an IRQ is the normal way to wait for the transaction to complete. This function call allows driver code to determine if an interrupt has been triggered on the DMA channel in order to filter spurious interrupts coming in. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00224">224</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a8e60e26858013365de9b0bba6bbe7284"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::initialise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIoBase.html">IoBase</a> *&#160;</td>
          <td class="paramname"><em>pBase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises DMA for a specific channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pBase</td><td>The IO base for this channel. This is, for example, BAR4 when working with PIIX's IDE interface. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the channel is set up and ready, false if not.</dd></dl>
<p>In the off chance the given IO base is not usable (null, wrong ports/mmio addresses, for example), being able to return false means controllers can detect a failure condition and avoid giving devices DMA information. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8cc_source.html#l00047">47</a> of file <a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a>.</p>

<p>References <a class="el" href="classPhysicalMemoryManager.html#ad78ba1e26381989a19ff1a35859a015c">PhysicalMemoryManager::allocateRegion()</a>, <a class="el" href="include_2pedigree_2kernel_2processor_2PhysicalMemoryManager_8h_source.html#l00044">PhysicalMemoryManager::continuous</a>, <a class="el" href="Log_8h_source.html#l00082">ERROR</a>, <a class="el" href="Log_8h_source.html#l00136">Hex</a>, <a class="el" href="armv7_2PhysicalMemoryManager_8cc_source.html#l00029">PhysicalMemoryManager::instance()</a>, <a class="el" href="Log_8h_source.html#l00074">NOTICE</a>, <a class="el" href="classIoBase.html#ada19286bfee3adb807e46f89c3a137f4">IoBase::size()</a>, and <a class="el" href="include_2pedigree_2kernel_2processor_2VirtualAddressSpace_8h_source.html#l00049">VirtualAddressSpace::Write</a>.</p>

<p>Referenced by <a class="el" href="PciAtaController_8cc_source.html#l00042">PciAtaController::PciAtaController()</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBusMasterIde_a8e60e26858013365de9b0bba6bbe7284_icgraph.png" border="0" usemap="#classBusMasterIde_a8e60e26858013365de9b0bba6bbe7284_icgraph" alt=""/></div>
<map name="classBusMasterIde_a8e60e26858013365de9b0bba6bbe7284_icgraph" id="classBusMasterIde_a8e60e26858013365de9b0bba6bbe7284_icgraph">
<area shape="rect" id="node2" href="classPciAtaController.html#a4ecebbc1ccbe372364d5931c892229d2" title="PciAtaController::PciAta\lController" alt="" coords="212,5,376,47"/>
<area shape="rect" id="node3" href="classPciAtaController.html#a4da01de55ebe791ef17246472620ec7e" title="PciAtaController::getName" alt="" coords="424,13,603,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca0573a028bf3e88608ea1b74af05d82"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::isActive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is there currently a DMA transaction taking place? </p>
<p>Calling <a class="el" href="classBusMasterIde.html#abc83797e4688ac4ec04ed2c14161f6d4" title="Begin a DMA operation. ">begin()</a> will begin a transaction, and calling commandComplete will end it. This is useful for controllers that may need to ACK an interrupt status for non-DMA transfers on IRQ. Simply clearing the status manually would cause pending DMA transfers to lose their status information. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00191">191</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

<p>Referenced by <a class="el" href="PciAtaController_8cc_source.html#l00390">PciAtaController::irq()</a>.</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBusMasterIde_aca0573a028bf3e88608ea1b74af05d82_icgraph.png" border="0" usemap="#classBusMasterIde_aca0573a028bf3e88608ea1b74af05d82_icgraph" alt=""/></div>
<map name="classBusMasterIde_aca0573a028bf3e88608ea1b74af05d82_icgraph" id="classBusMasterIde_aca0573a028bf3e88608ea1b74af05d82_icgraph">
<area shape="rect" id="node2" href="classPciAtaController.html#ab8e5bcf18c8f248b9ff9eb298a22add6" title="PciAtaController::irq" alt="" coords="212,42,351,69"/>
<area shape="rect" id="node3" href="classPciAtaController.html#a4ecebbc1ccbe372364d5931c892229d2" title="PciAtaController::PciAta\lController" alt="" coords="399,5,563,47"/>
<area shape="rect" id="node4" href="classPciAtaController.html#a4da01de55ebe791ef17246472620ec7e" title="PciAtaController::getName" alt="" coords="611,42,789,69"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a6375cf97db78fcae0359c9bd7974ce14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool BusMasterIde::m_bActive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether or not a DMA transfer is currently active. </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00217">217</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

<p>Referenced by <a class="el" href="Cache_8cc_source.html#l00140">CacheManager::executeRequest()</a>, and <a class="el" href="Cache_8cc_source.html#l00078">CacheManager::initialise()</a>.</p>

</div>
</div>
<a class="anchor" id="a43863c198347ec4eeb593c477695112a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t BusMasterIde::m_LastPrdTableOffset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Last used offset into the PRD table (so we can run multiple ops at once) </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00208">208</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<a class="anchor" id="a64281433ea7409513cb8bfbeb57bde2e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIoBase.html">IoBase</a>* BusMasterIde::m_pBase</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal I/O base </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00198">198</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<a class="anchor" id="afd20e1a00214d0882733b710cec37a3b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PhysicalRegionDescriptor* BusMasterIde::m_PrdTable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PRD table (virtual) </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00204">204</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa5f6ae84963e5d3b46c536198a4b3bb3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMutex.html">Mutex</a> BusMasterIde::m_PrdTableLock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PRD table lock. This is used when inserting items to the PRDT </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00201">201</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaf29f57c538991abac88e2fb9b381120"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryRegion.html">MemoryRegion</a> BusMasterIde::m_PrdTableMemRegion</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classMemoryRegion.html" title="Special memory entity in the kernel&#39;s virtual address space. ">MemoryRegion</a> for the PRD table </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00214">214</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac1279a7c02c9ab63cd54d5e462c426e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">physical_uintptr_t BusMasterIde::m_PrdTablePhys</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PRD table (physical) </p>

<p>Definition at line <a class="el" href="BusMasterIde_8h_source.html#l00211">211</a> of file <a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="BusMasterIde_8h_source.html">BusMasterIde.h</a></li>
<li><a class="el" href="BusMasterIde_8cc_source.html">BusMasterIde.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 24 2020 06:49:10 for The Pedigree Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
