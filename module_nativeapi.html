<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>The Pedigree Project: Native API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Pedigree Project
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Native API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000075">Todo:</a></b></dt><dd>Write a new configuration system API using the new native API scheme. </dd></dl>
<p>Pedigree offers a native API alongside the more-portable POSIX API. While the POSIX API facilitates writing portable software, it is also a heavy abstraction over the core Pedigree functionality. The native API is able to avoid many of the compromises that this abstraction forces.</p>
<p>The native API consists exclusively of C++ objects that can be instantiated by applications. Method calls on these instances automatically handle calling into the kernel if that is necessary.</p>
<p>The main set of operations that become simpler when using the native API rather than the POSIX API include, but are not limited to, the following:</p><ul>
<li>Better support for native Pedigree paths (fooÂ»/bar)</li>
<li>More flexible memory mapping provisions</li>
</ul>
<h1><a class="anchor" id="module_nativeapi_basics"></a>
Basics</h1>
<p>Each application class in the native API has a globally unique identifier. When the class is instantiated, the new instance is registered with the kernel using this identifier. The kernel allocates resources for the request and maps the new instance to the kernel instance. This allows for state to be kept both in the kernel and in the application, as needed.</p>
<p>Objects are automatically unregistered when they are destroyed. This allows for the use of RAII by applications to ensure resources are cleaned up when the application is finished with them.</p>
<p>System calls are made when needed by the application class. These consist of a method ID which is specific to the class, and a parameter block. It is recommended that the parameter block always contain a version field so that past revisions of the parameter block can be handled properly. The kernel class implements a syscall() method that receives the method ID and the parameter block and determines what to do as a result.</p>
<p>A  object is provided for all native calls which allows for rich metadata about the result of a call to be provided. This is especially useful for allowing the kernel to report exceptions to be raised by the application class. Indeed, all errors should be reported using C++ exceptions rather than integral statuses.</p>
<h1><a class="anchor" id="module_nativeapi_howto"></a>
Adding to the API</h1>
<p>The process for adding a new API to the native API is reasonably simple.</p>
<p>First, define a global unique identifier in <a class="el" href="nativeSyscallNumbers_8h_source.html">nativeSyscallNumbers.h</a>.</p>
<p>Having created this identifier, create the kernel and application classes. The kernel class should inherit from <code><a class="el" href="classNativeBase.html">NativeBase</a></code>, and the application class should inherit from <code><a class="el" href="classObject.html">Object</a></code>. Override <code><a class="el" href="classObject.html#a67078550738d39db5a25d473fe38e246">Object::guid</a></code> on the application class.</p>
<p>Add the creation of an instance of the kernel class to <code><a class="el" href="classNativeSyscallManager.html#a8f4af5737d434ca63254566bd567d561">NativeSyscallManager::factory</a></code></p>
<p>Override <code><a class="el" href="classNativeBase.html#a6b571f2fa79fb20cf32ae92f08417e4c">NativeBase::syscall</a></code> on the kernel class. It is acceptable to initially write a stub which always returns 'unsuccessful'.</p>
<p>Implement functionality in the application and kernel classes as needed.</p>
<h1><a class="anchor" id="module_nativeapi_categories"></a>
API Categories</h1>
<p>The following are a list of general API categories in which most APIs fit.</p>
<p>... </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 24 2020 06:49:09 for The Pedigree Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
