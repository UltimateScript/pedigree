<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>The Pedigree Project: Cache Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Pedigree Project
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classCache-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Cache Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Cache_8h_source.html">Cache.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Cache:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache__coll__graph.png" border="0" usemap="#Cache_coll__map" alt="Collaboration graph"/></div>
<map name="Cache_coll__map" id="Cache_coll__map">
<area shape="rect" id="node2" href="classSpinlock.html" title="{Spinlock\n|+ allow_recursion\l&#45; m_bInterrupts\l&#45; m_Sentinel\l&#45; m_Magic\l&#45; m_MagicAlign\l&#45; m_pOwner\l&#45; m_Level\l&#45; m_OwnedProcessor\l&#45; m_Ra\l&#45; m_bAvoidTracking\l&#45; m_bOwned\l|+ Spinlock()\l+ Spinlock()\l+ acquire()\l+ exit()\l+ release()\l+ acquired()\l+ interrupts()\l&#45; unwind()\l&#45; trackRelease()\l}" alt="" coords="119,1089,267,1431"/>
<area shape="rect" id="node3" href="classAtomic.html" title="{Atomic\&lt; uint64_t \&gt;\n||}" alt="" coords="5,733,139,810"/>
<area shape="rect" id="node4" href="classAtomic.html" title="{Atomic\&lt; T, bAllow \&gt;\n||}" alt="" coords="147,329,290,406"/>
<area shape="rect" id="node5" href="classAtomic.html" title="{Atomic\&lt; bool \&gt;\n||}" alt="" coords="163,733,274,810"/>
<area shape="rect" id="node6" href="classAtomic.html" title="{Atomic\&lt; size_t \&gt;\n||}" alt="" coords="257,973,380,1051"/>
<area shape="rect" id="node7" href="classRangeList.html" title="{RangeList\&lt; T, Reversed \&gt;\n|&#45; Iterator\l&#45; ConstIterator\l&#45; ReverseIterator\l&#45; ConstReverseIterator\l&#45; m_bPreferUsed\l|+ RangeList()\l+ RangeList()\l+ RangeList()\l+ ~RangeList()\l+ RangeList()\l+ operator=()\l+ free()\l+ allocate()\l+ allocateSpecific()\l+ clear()\l+ size()\l+ getRange()\l+ sweep()\l+ dump()\l}" alt="" coords="429,1097,606,1423"/>
<area shape="rect" id="node8" href="classVector.html" title="{Vector\&lt; RangeList::\lRange * \&gt;\n|&#45; m_Size\l&#45; m_Count\l&#45; m_Start\l&#45; m_ReserveFactor\l|+ Vector()\l+ Vector()\l+ Vector()\l+ ~Vector()\l+ operator=()\l+ operator[]()\l+ size()\l+ count()\l+ pushBack()\l+ popBack()\land 19 more...\l&#45; reserve()\l}" alt="" coords="423,623,561,920"/>
<area shape="rect" id="node9" href="structRangeList_1_1Range.html" title="{RangeList\&lt; T, Reversed\l \&gt;::Range\n||+ Range()\l+ operator==()\l}" alt="" coords="320,314,485,421"/>
<area shape="rect" id="node11" href="classVector.html" title="A vector / dynamic array. " alt="" coords="510,226,645,509"/>
<area shape="rect" id="node12" href="classBloomFilter.html" title="{BloomFilter\&lt; uintptr_t \&gt;\n|&#45; m_nLength\l&#45; m_nHashCount\l|+ BloomFilter()\l+ ~BloomFilter()\l+ add()\l+ add()\l+ contains()\l+ contains()\l+ clear()\l}" alt="" coords="630,1170,789,1350"/>
<area shape="rect" id="node13" href="classExtensibleBitmap.html" title="{ExtensibleBitmap\n|&#45; m_StaticMap\l&#45; m_pDynamicMap\l&#45; m_DynamicMapSize\l&#45; m_nMaxBit\l&#45; m_nFirstSetBit\l&#45; m_nFirstClearBit\l&#45; m_nLastSetBit\l&#45; m_nLastClearBit\l|+ ExtensibleBitmap()\l+ ExtensibleBitmap()\l+ ~ExtensibleBitmap()\l+ operator=()\l+ set()\l+ clear()\l+ test()\l+ getFirstSet()\l+ getFirstClear()\l+ getLastSet()\l+ getLastClear()\l}" alt="" coords="693,204,845,531"/>
<area shape="rect" id="node14" href="classBloomFilter.html" title="{BloomFilter\&lt; T \&gt;\n|&#45; m_nLength\l&#45; m_nHashCount\l|+ BloomFilter()\l+ ~BloomFilter()\l+ add()\l+ add()\l+ contains()\l+ contains()\l+ clear()\l}" alt="" coords="747,681,869,861"/>
<area shape="rect" id="node15" href="classTree.html" title="{Tree\&lt; uintptr_t, Cache\l::CachePage * \&gt;\n|&#45; nItems\l|+ Tree()\l+ Tree()\l+ ~Tree()\l+ operator=()\l+ count()\l+ insert()\l+ insert()\l+ lookup()\l+ lookupRef()\l+ contains()\land 7 more...\l&#45; copyFrom()\l&#45; rotateLeft()\l&#45; rotateRight()\l&#45; height()\l&#45; balanceFactor()\l&#45; rebalanceNode()\l&#45; traverseNode_Insert()\l&#45; traverseNode_Remove()\l&#45; createInsertionNode()\l}" alt="" coords="821,1075,993,1445"/>
<area shape="rect" id="node16" href="classTree_1_1IteratorNode.html" title="{Tree\&lt; K, E \&gt;::IteratorNode\n||+ IteratorNode()\l+ IteratorNode()\l+ next()\l+ previous()\l+ reset()\l&#45; traverseNext()\l}" alt="" coords="944,292,1123,443"/>
<area shape="rect" id="node18" href="classTree.html" title="A key/value dictionary. " alt="" coords="1053,593,1225,949"/>
<area shape="rect" id="node17" href="structTree_1_1Node.html" title="{Tree\&lt; K, E \&gt;::Node\n|+ key\l+ element\l+ height\l|}" alt="" coords="965,5,1102,112"/>
<area shape="rect" id="node19" href="structCache_1_1CachePage.html" title="{Cache::CachePage\n|+ key\l+ location\l+ refcnt\l+ checksum\l+ checksumChanging\l+ status\l|+ checkChecksum()\l+ checkZeroChecksum()\l}" alt="" coords="1017,1177,1183,1343"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCache_1_1CachePage.html">CachePage</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCache_1_1callbackMeta.html">callbackMeta</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aacb3a645b9380ddd06be3d6e0245428a"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#aacb3a645b9380ddd06be3d6e0245428a">writeback_t</a>) (CacheConstants::CallbackCause cause, uintptr_t loc, uintptr_t page, void *meta)</td></tr>
<tr class="separator:aacb3a645b9380ddd06be3d6e0245428a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afbe1754f76f4ce228d7e1a89f107b6f9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afbe1754f76f4ce228d7e1a89f107b6f9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Cache</b> (size_t pageConstraints=0)</td></tr>
<tr class="separator:afbe1754f76f4ce228d7e1a89f107b6f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33781f985754a794f2dd19729a2d5170"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a33781f985754a794f2dd19729a2d5170">setCallback</a> (<a class="el" href="classCache.html#aacb3a645b9380ddd06be3d6e0245428a">writeback_t</a> newCallback, void *meta)</td></tr>
<tr class="separator:a33781f985754a794f2dd19729a2d5170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e0c58a9355042046071ef908fdcbac"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ad7e0c58a9355042046071ef908fdcbac">lookup</a> (uintptr_t key)</td></tr>
<tr class="separator:ad7e0c58a9355042046071ef908fdcbac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f7b84d141953a59fea124497afe432"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a54f7b84d141953a59fea124497afe432">insert</a> (uintptr_t key, bool *alreadyExisted=nullptr)</td></tr>
<tr class="separator:a54f7b84d141953a59fea124497afe432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a267e70a1010cef13b62a5c0b25983"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a93a267e70a1010cef13b62a5c0b25983">insert</a> (uintptr_t key, size_t size, bool *alreadyExisted=nullptr)</td></tr>
<tr class="separator:a93a267e70a1010cef13b62a5c0b25983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a057b1df031ade2c55d08066dc39a635f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a057b1df031ade2c55d08066dc39a635f">exists</a> (uintptr_t key, size_t length)</td></tr>
<tr class="separator:a057b1df031ade2c55d08066dc39a635f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3980d09f450684e12c49d680959c819b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a3980d09f450684e12c49d680959c819b">evict</a> (uintptr_t key)</td></tr>
<tr class="separator:a3980d09f450684e12c49d680959c819b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d048634b6ee5404e9e741f7fb6cc5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ab9d048634b6ee5404e9e741f7fb6cc5d">empty</a> ()</td></tr>
<tr class="separator:ab9d048634b6ee5404e9e741f7fb6cc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a4f0916381ef6f3cd5ae0a1139e80d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a3a4f0916381ef6f3cd5ae0a1139e80d1">release</a> (uintptr_t key)</td></tr>
<tr class="separator:a3a4f0916381ef6f3cd5ae0a1139e80d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee0f83ac85871b808f2b0dcce9c55034"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#aee0f83ac85871b808f2b0dcce9c55034">pin</a> (uintptr_t key)</td></tr>
<tr class="separator:aee0f83ac85871b808f2b0dcce9c55034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a698aaab39860f6f9ecf45074e4f58059"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a698aaab39860f6f9ecf45074e4f58059">trim</a> (size_t count=1)</td></tr>
<tr class="separator:a698aaab39860f6f9ecf45074e4f58059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49319c0bbb177eb08db38a2958bf5611"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a49319c0bbb177eb08db38a2958bf5611">sync</a> (uintptr_t key, bool async)</td></tr>
<tr class="separator:a49319c0bbb177eb08db38a2958bf5611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab95b124344edcb2f63365a8e283e6769"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ab95b124344edcb2f63365a8e283e6769">triggerChecksum</a> (uintptr_t key)</td></tr>
<tr class="separator:ab95b124344edcb2f63365a8e283e6769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63205a7e5c3bc8555e14a1cfd34856cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a63205a7e5c3bc8555e14a1cfd34856cd">startAtomic</a> ()</td></tr>
<tr class="separator:a63205a7e5c3bc8555e14a1cfd34856cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35700b0657aea9559dd88df1d6d326ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a35700b0657aea9559dd88df1d6d326ce">endAtomic</a> ()</td></tr>
<tr class="separator:a35700b0657aea9559dd88df1d6d326ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b43996874d4cdf4e5d8c4eae301887"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a67b43996874d4cdf4e5d8c4eae301887">markEditing</a> (uintptr_t key, size_t length=0)</td></tr>
<tr class="separator:a67b43996874d4cdf4e5d8c4eae301887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4db24b52db611a86e94b4ff20232edb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ad4db24b52db611a86e94b4ff20232edb">markNoLongerEditing</a> (uintptr_t key, size_t length=0)</td></tr>
<tr class="separator:ad4db24b52db611a86e94b4ff20232edb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e2cbc66e8c1d8709ea556ab2c973e36"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a5e2cbc66e8c1d8709ea556ab2c973e36">timer</a> (uint64_t delta, InterruptState &amp;state)</td></tr>
<tr class="separator:a5e2cbc66e8c1d8709ea556ab2c973e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c32c607d000ae9a917a20d80312350"><td class="memItemLeft" align="right" valign="top">virtual uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a60c32c607d000ae9a917a20d80312350">executeRequest</a> (uint64_t p1, uint64_t p2, uint64_t p3, uint64_t p4, uint64_t p5, uint64_t p6, uint64_t p7, uint64_t p8)</td></tr>
<tr class="separator:a60c32c607d000ae9a917a20d80312350"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4cc09c83e2cbbc57c7776acba57a2985"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a4cc09c83e2cbbc57c7776acba57a2985">map</a> (uintptr_t virt) const </td></tr>
<tr class="separator:a4cc09c83e2cbbc57c7776acba57a2985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9325f14b0e3b3276566e9a68f6ec81d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ae9325f14b0e3b3276566e9a68f6ec81d">evict</a> (uintptr_t key, bool bLock, bool bPhysicalLock, bool bRemove)</td></tr>
<tr class="separator:ae9325f14b0e3b3276566e9a68f6ec81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0718417b7108a0b376820a5618b8b5ee"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a0718417b7108a0b376820a5618b8b5ee">lruEvict</a> (bool force=false)</td></tr>
<tr class="separator:a0718417b7108a0b376820a5618b8b5ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0304a63f46544984011cbac1b7ca5e14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a0304a63f46544984011cbac1b7ca5e14">linkPage</a> (<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *pPage)</td></tr>
<tr class="separator:a0304a63f46544984011cbac1b7ca5e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0e6f1a86035400d840b4128dc117d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a0f0e6f1a86035400d840b4128dc117d8">promotePage</a> (<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *pPage)</td></tr>
<tr class="separator:a0f0e6f1a86035400d840b4128dc117d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad48828b3f2b33caf4688fbd228fcba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a3ad48828b3f2b33caf4688fbd228fcba">unlinkPage</a> (<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *pPage)</td></tr>
<tr class="separator:a3ad48828b3f2b33caf4688fbd228fcba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b5567194c2ae95a45fd0c862f2f474"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#af3b5567194c2ae95a45fd0c862f2f474">calculateChecksum</a> (<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *pPage)</td></tr>
<tr class="separator:af3b5567194c2ae95a45fd0c862f2f474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f1be5e296552d0779997cb6a4f4c95"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a48f1be5e296552d0779997cb6a4f4c95">verifyChecksum</a> (<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *pPage, bool replace=false)</td></tr>
<tr class="separator:a48f1be5e296552d0779997cb6a4f4c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9337d00dee88e8e85b23cd8578c3efe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ad9337d00dee88e8e85b23cd8578c3efe">checksum</a> (const void *data, size_t len, uint64_t out[2])</td></tr>
<tr class="separator:ad9337d00dee88e8e85b23cd8578c3efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab1b7db14fa5e0b5c6beeadd3d1887172"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTree.html">Tree</a>&lt; uintptr_t, <a class="el" href="structCache_1_1CachePage.html">CachePage</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ab1b7db14fa5e0b5c6beeadd3d1887172">m_Pages</a></td></tr>
<tr class="separator:ab1b7db14fa5e0b5c6beeadd3d1887172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a6db8399d5411119bc645d85b107912"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBloomFilter.html">BloomFilter</a>&lt; uintptr_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a9a6db8399d5411119bc645d85b107912">m_PageFilter</a></td></tr>
<tr class="separator:a9a6db8399d5411119bc645d85b107912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9990597a441582e85d8bddaf5bcbbda3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a9990597a441582e85d8bddaf5bcbbda3">m_pLruHead</a></td></tr>
<tr class="separator:a9990597a441582e85d8bddaf5bcbbda3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18273b88f99bf4169b4eecc93b438fcf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a18273b88f99bf4169b4eecc93b438fcf"></a>
<a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>m_pLruTail</b></td></tr>
<tr class="separator:a18273b88f99bf4169b4eecc93b438fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1f69ced64606de12ef2c956fb1a6b81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSpinlock.html">Spinlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#ae1f69ced64606de12ef2c956fb1a6b81">m_Lock</a></td></tr>
<tr class="separator:ae1f69ced64606de12ef2c956fb1a6b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c82d2fa13015b57a37db5a275aa71f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCache.html#aacb3a645b9380ddd06be3d6e0245428a">writeback_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a58c82d2fa13015b57a37db5a275aa71f">m_Callback</a></td></tr>
<tr class="separator:a58c82d2fa13015b57a37db5a275aa71f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2149bc3d104f0321742c437ef4403e"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a4a2149bc3d104f0321742c437ef4403e">m_Nanoseconds</a></td></tr>
<tr class="separator:a4a2149bc3d104f0321742c437ef4403e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc58a498a96ed0b3edff877d2f4ecd8e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#afc58a498a96ed0b3edff877d2f4ecd8e">m_CallbackMeta</a></td></tr>
<tr class="separator:afc58a498a96ed0b3edff877d2f4ecd8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e2244ea992c61be51e6d6d6ddeac33d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAtomic.html">Atomic</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a9e2244ea992c61be51e6d6d6ddeac33d">m_bInCritical</a></td></tr>
<tr class="separator:a9e2244ea992c61be51e6d6d6ddeac33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd4872c514bd9aa6e3b95a50456f474"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a8cd4872c514bd9aa6e3b95a50456f474">m_PageConstraints</a></td></tr>
<tr class="separator:a8cd4872c514bd9aa6e3b95a50456f474"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:aa00cf09971efce081daf9849c8e02e47"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classRangeList.html">MemoryAllocator</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#aa00cf09971efce081daf9849c8e02e47">m_Allocator</a></td></tr>
<tr class="separator:aa00cf09971efce081daf9849c8e02e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a40d549384db54b7270285b78805b3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSpinlock.html">Spinlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCache.html#a20a40d549384db54b7270285b78805b3">m_AllocatorLock</a></td></tr>
<tr class="separator:a20a40d549384db54b7270285b78805b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides an abstraction of a data cache. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00118">118</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="aacb3a645b9380ddd06be3d6e0245428a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* Cache::writeback_t) (CacheConstants::CallbackCause cause, uintptr_t loc, uintptr_t page, void *meta)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback type: for functions called by the write-back timer handler.</p>
<p>The write-back handler checks all pages in the cache at a regular interval. If it finds a dirty page, it calls the <a class="el" href="classCache.html">Cache</a> callback, which should write the modified data back to a backing store, if any exists.</p>
<p>Then, the write-back thread will mark the page as not-dirty. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00177">177</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="af3b5567194c2ae95a45fd0c862f2f474"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::calculateChecksum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td>
          <td class="paramname"><em>pPage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate a checksum for the given <a class="el" href="structCache_1_1CachePage.html">CachePage</a>. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00855">855</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00134">Cache::CachePage::checksum</a>, and <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>.</p>

</div>
</div>
<a class="anchor" id="ad9337d00dee88e8e85b23cd8578c3efe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::checksum </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>out</em>[2]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Checksum do-er. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00879">879</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ab9d048634b6ee5404e9e741f7fb6cc5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Empties the cache.</p>
<p>Will not respect refcounts. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00460">460</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>.</p>

</div>
</div>
<a class="anchor" id="a35700b0657aea9559dd88df1d6d326ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::endAtomic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Leaves the critical section for this cache. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00291">291</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3980d09f450684e12c49d680959c819b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::evict </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evicts the given key from the cache, also freeing the memory it holds.</p>
<p>This will respect the refcount of the given key, so as to make <a class="el" href="classCache.html#aee0f83ac85871b808f2b0dcce9c55034">pin()</a> exhibit more reliable behaviour. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00455">455</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae9325f14b0e3b3276566e9a68f6ec81d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::evict </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bLock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bPhysicalLock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bRemove</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>evict doer </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00477">477</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Spinlock_8cc_source.html#l00043">Spinlock::acquire()</a>, <a class="el" href="classPhysicalMemoryManager.html#a9fe34b1e71f436126da963ba5ef49d2b">PhysicalMemoryManager::freePage()</a>, <a class="el" href="classVirtualAddressSpace.html#a4c099087b6db046a7a72b0481d4b2827">VirtualAddressSpace::getMapping()</a>, <a class="el" href="Processor_8cc_source.html#l00045">Processor::information()</a>, <a class="el" href="armv7_2PhysicalMemoryManager_8cc_source.html#l00029">PhysicalMemoryManager::instance()</a>, <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, <a class="el" href="Log_8h_source.html#l00074">NOTICE</a>, <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>, <a class="el" href="Spinlock_8cc_source.html#l00273">Spinlock::release()</a>, and <a class="el" href="classVirtualAddressSpace.html#ae72fef9c0fe9eb7bddfd3bde51b2d009">VirtualAddressSpace::unmap()</a>.</p>

</div>
</div>
<a class="anchor" id="a60c32c607d000ae9a917a20d80312350"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t Cache::executeRequest </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>p8</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classRequestQueue.html">RequestQueue</a> doer, called by the <a class="el" href="classCacheManager.html">CacheManager</a> instance. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00765">765</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Log_8h_source.html#l00074">NOTICE</a>.</p>

<p>Referenced by <a class="el" href="Cache_8cc_source.html#l00140">CacheManager::executeRequest()</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_a60c32c607d000ae9a917a20d80312350_icgraph.png" border="0" usemap="#classCache_a60c32c607d000ae9a917a20d80312350_icgraph" alt=""/></div>
<map name="classCache_a60c32c607d000ae9a917a20d80312350_icgraph" id="classCache_a60c32c607d000ae9a917a20d80312350_icgraph">
<area shape="rect" id="node2" href="classCacheManager.html#aee44abeaf9f1cf4f62c95485ee879844" title="CacheManager::executeRequest" alt="" coords="216,5,429,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a057b1df031ade2c55d08066dc39a635f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::exists </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if the entire range specified exists in the cache. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00431">431</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>.</p>

</div>
</div>
<a class="anchor" id="a54f7b84d141953a59fea124497afe432"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t Cache::insert </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>alreadyExisted</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a cache entry with the given key.</p>
<p>The new entry will already be marked as being edited, and so won't be written back until the inserter calls markNoLongerEditing again.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alreadyExisted</td><td>can be used to find out if the return value is a page that already existed, and no mapping was completed. This can be used to do an 'insert or get' operation atomically. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000554">Todo:</a></b></dt><dd>remove this, it makes the bloom filter pointless </dd></dl>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00258">258</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00134">Cache::CachePage::checksum</a>, <a class="el" href="Log_8h_source.html#l00089">FATAL</a>, <a class="el" href="Cache_8h_source.html#l00124">Cache::CachePage::key</a>, <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>.</p>

<p>Referenced by <a class="el" href="DiskImage_8cc_source.html#l00042">DiskImage::read()</a>, <a class="el" href="FatFile_8cc_source.html#l00044">FatFile::readBlock()</a>, and <a class="el" href="File_8cc_source.html#l00816">File::readIntoCache()</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_a54f7b84d141953a59fea124497afe432_icgraph.png" border="0" usemap="#classCache_a54f7b84d141953a59fea124497afe432_icgraph" alt=""/></div>
<map name="classCache_a54f7b84d141953a59fea124497afe432_icgraph" id="classCache_a54f7b84d141953a59fea124497afe432_icgraph">
<area shape="rect" id="node2" href="classDiskImage.html#a42765c496a07295a42a12e9db4e747e7" title="DiskImage::read" alt="" coords="162,31,281,57"/>
<area shape="rect" id="node4" href="classFatFile.html#ac2bb223e5028c8e64708e091da725b92" title="FatFile::readBlock" alt="" coords="157,81,285,108"/>
<area shape="rect" id="node5" href="classFile.html#a8be3584ef2f2a607cee6ed7f36784876" title="File::readIntoCache" alt="" coords="153,132,289,159"/>
<area shape="rect" id="node3" href="classDiskImage.html#aca6bbf631caaaa94d8d6ca53f5261250" title="DiskImage::dump" alt="" coords="337,31,463,57"/>
<area shape="rect" id="node6" href="classFile.html#a29f9b0b8ee6a02ef8c5deb2b516fc022" title="File::read" alt="" coords="362,107,438,133"/>
<area shape="rect" id="node12" href="classFile.html#a4fb6cc9ecdd0abf699a3115069e868d5" title="File::write" alt="" coords="361,300,439,327"/>
<area shape="rect" id="node7" href="classMemoryMappedFile.html#a66353cd31e469385cd9492879fd8e834" title="MemoryMappedFile::setPermissions" alt="" coords="511,5,745,32"/>
<area shape="rect" id="node8" href="classPosixSubsystem.html#a5bbd21893924596a4ef7fcb134d94e33" title="PosixSubsystem::parseShebang" alt="" coords="522,56,734,83"/>
<area shape="rect" id="node9" href="classPosixSubsystem.html#a0f81eb461d078c36950283ce71a45e05" title="PosixSubsystem::invoke" alt="" coords="793,81,960,108"/>
<area shape="rect" id="node10" href="classSymlink.html#a5fe1e7dba3adb206dca4bb897824d7e4" title="Symlink::initialise" alt="" coords="566,157,690,184"/>
<area shape="rect" id="node11" href="classSymlink.html#a08f184455757dec97a82d974280f52b3" title="Symlink::followLink" alt="" coords="809,157,944,184"/>
<area shape="rect" id="node13" href="classConsolePhysicalFile.html#a6648a523228720e05ccc4a4fa505aecc" title="ConsolePhysicalFile\l::readBytewise" alt="" coords="557,209,699,250"/>
<area shape="rect" id="node14" href="classDevFs.html#a7975b933760278dd9bdbd0fceff87fa6" title="DevFs::initialise" alt="" coords="570,275,686,301"/>
<area shape="rect" id="node15" href="classExt2Filesystem.html#a01ee85a4315570e134649db8862790c9" title="Ext2Filesystem::createNode" alt="" coords="534,325,722,352"/>
<area shape="rect" id="node16" href="classFatFilesystem.html#a302aa4ab6a7cf1be10758d424de2b367" title="FatFilesystem::createSymlink" alt="" coords="530,376,726,403"/>
<area shape="rect" id="node17" href="classUnixSocketSyscalls.html#a894d6c12d21ffc3588847ecbed648fcc" title="UnixSocketSyscalls\l::sendto_msg" alt="" coords="558,427,698,469"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a93a267e70a1010cef13b62a5c0b25983"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t Cache::insert </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>alreadyExisted</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a bunch of cache entries to fill a specific size. Note that this is just a monster allocation of a virtual address - the physical pages are NOT CONTIGUOUS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alreadyExisted</td><td>can be used to find out if the return value is a page that already existed, and no mapping was completed. This can be used to do an 'insert or get' operation atomically. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000555">Todo:</a></b></dt><dd>no - this doesn't check the full size! </dd></dl>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00329">329</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00134">Cache::CachePage::checksum</a>, <a class="el" href="Log_8h_source.html#l00138">Dec</a>, <a class="el" href="Log_8h_source.html#l00082">ERROR</a>, <a class="el" href="Log_8h_source.html#l00089">FATAL</a>, <a class="el" href="Log_8h_source.html#l00136">Hex</a>, <a class="el" href="Cache_8h_source.html#l00124">Cache::CachePage::key</a>, <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>, and <a class="el" href="Log_8h_source.html#l00078">WARNING</a>.</p>

</div>
</div>
<a class="anchor" id="a0304a63f46544984011cbac1b7ca5e14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::linkPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td>
          <td class="paramname"><em>pPage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Link the given <a class="el" href="structCache_1_1CachePage.html">CachePage</a> to the LRU list. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00826">826</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00156">Cache::CachePage::pNext</a>.</p>

</div>
</div>
<a class="anchor" id="ad7e0c58a9355042046071ef908fdcbac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t Cache::lookup </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Looks for <code>key</code> , increasing <code>refcnt</code> by one if returned. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00235">235</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>.</p>

<p>Referenced by <a class="el" href="File_8cc_source.html#l00242">File::getPhysicalPage()</a>, and <a class="el" href="DiskImage_8cc_source.html#l00042">DiskImage::read()</a>.</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_ad7e0c58a9355042046071ef908fdcbac_icgraph.png" border="0" usemap="#classCache_ad7e0c58a9355042046071ef908fdcbac_icgraph" alt=""/></div>
<map name="classCache_ad7e0c58a9355042046071ef908fdcbac_icgraph" id="classCache_ad7e0c58a9355042046071ef908fdcbac_icgraph">
<area shape="rect" id="node2" href="classFile.html#a8a7c1b5ac4f646c7cb8eeb7708772228" title="File::getPhysicalPage" alt="" coords="160,5,309,32"/>
<area shape="rect" id="node4" href="classDiskImage.html#a42765c496a07295a42a12e9db4e747e7" title="DiskImage::read" alt="" coords="175,56,294,83"/>
<area shape="rect" id="node3" href="classMemoryMappedFile.html#a66353cd31e469385cd9492879fd8e834" title="MemoryMappedFile::setPermissions" alt="" coords="357,5,592,32"/>
<area shape="rect" id="node5" href="classDiskImage.html#aca6bbf631caaaa94d8d6ca53f5261250" title="DiskImage::dump" alt="" coords="412,56,537,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0718417b7108a0b376820a5618b8b5ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Cache::lruEvict </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>LRU evict do-er.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">force</td><td>force an eviction to be attempted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of cache pages evicted </dd></dl>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00799">799</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="armv7_2PhysicalMemoryManager_8cc_source.html#l00029">PhysicalMemoryManager::instance()</a>, and <a class="el" href="Cache_8h_source.html#l00124">Cache::CachePage::key</a>.</p>

</div>
</div>
<a class="anchor" id="a4cc09c83e2cbbc57c7776acba57a2985"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::map </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>virt</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>mapping doer </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00417">417</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="classPhysicalMemoryManager.html#a3db8d519f649a174ac28cd8c18e4ec5c">PhysicalMemoryManager::allocatePage()</a>, <a class="el" href="Processor_8cc_source.html#l00045">Processor::information()</a>, <a class="el" href="armv7_2PhysicalMemoryManager_8cc_source.html#l00029">PhysicalMemoryManager::instance()</a>, <a class="el" href="include_2pedigree_2kernel_2processor_2VirtualAddressSpace_8h_source.html#l00047">VirtualAddressSpace::KernelMode</a>, and <a class="el" href="include_2pedigree_2kernel_2processor_2VirtualAddressSpace_8h_source.html#l00049">VirtualAddressSpace::Write</a>.</p>

</div>
</div>
<a class="anchor" id="a67b43996874d4cdf4e5d8c4eae301887"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::markEditing </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark the given page as being edited.</p>
<p>A page being edited will never be written back, nor will its checksum be calculated. Once a page is no longer being edited, it goes into an intermediate mode that means it'll have its checksum calculated asynchronously. After that point, normal checksum-based writebacks take place. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00884">884</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Log_8h_source.html#l00078">WARNING</a>.</p>

</div>
</div>
<a class="anchor" id="ad4db24b52db611a86e94b4ff20232edb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::markNoLongerEditing </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark the given page as no longer being edited. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00919">919</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Log_8h_source.html#l00078">WARNING</a>.</p>

<p>Referenced by <a class="el" href="DiskImage_8cc_source.html#l00042">DiskImage::read()</a>, <a class="el" href="FatFile_8cc_source.html#l00044">FatFile::readBlock()</a>, and <a class="el" href="File_8cc_source.html#l00816">File::readIntoCache()</a>.</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_ad4db24b52db611a86e94b4ff20232edb_icgraph.png" border="0" usemap="#classCache_ad4db24b52db611a86e94b4ff20232edb_icgraph" alt=""/></div>
<map name="classCache_ad4db24b52db611a86e94b4ff20232edb_icgraph" id="classCache_ad4db24b52db611a86e94b4ff20232edb_icgraph">
<area shape="rect" id="node2" href="classDiskImage.html#a42765c496a07295a42a12e9db4e747e7" title="DiskImage::read" alt="" coords="255,31,374,57"/>
<area shape="rect" id="node4" href="classFatFile.html#ac2bb223e5028c8e64708e091da725b92" title="FatFile::readBlock" alt="" coords="251,81,379,108"/>
<area shape="rect" id="node5" href="classFile.html#a8be3584ef2f2a607cee6ed7f36784876" title="File::readIntoCache" alt="" coords="247,132,383,159"/>
<area shape="rect" id="node3" href="classDiskImage.html#aca6bbf631caaaa94d8d6ca53f5261250" title="DiskImage::dump" alt="" coords="431,31,556,57"/>
<area shape="rect" id="node6" href="classFile.html#a29f9b0b8ee6a02ef8c5deb2b516fc022" title="File::read" alt="" coords="455,107,531,133"/>
<area shape="rect" id="node12" href="classFile.html#a4fb6cc9ecdd0abf699a3115069e868d5" title="File::write" alt="" coords="454,300,533,327"/>
<area shape="rect" id="node7" href="classMemoryMappedFile.html#a66353cd31e469385cd9492879fd8e834" title="MemoryMappedFile::setPermissions" alt="" coords="604,5,839,32"/>
<area shape="rect" id="node8" href="classPosixSubsystem.html#a5bbd21893924596a4ef7fcb134d94e33" title="PosixSubsystem::parseShebang" alt="" coords="615,56,827,83"/>
<area shape="rect" id="node9" href="classPosixSubsystem.html#a0f81eb461d078c36950283ce71a45e05" title="PosixSubsystem::invoke" alt="" coords="887,81,1053,108"/>
<area shape="rect" id="node10" href="classSymlink.html#a5fe1e7dba3adb206dca4bb897824d7e4" title="Symlink::initialise" alt="" coords="659,157,783,184"/>
<area shape="rect" id="node11" href="classSymlink.html#a08f184455757dec97a82d974280f52b3" title="Symlink::followLink" alt="" coords="903,157,1037,184"/>
<area shape="rect" id="node13" href="classConsolePhysicalFile.html#a6648a523228720e05ccc4a4fa505aecc" title="ConsolePhysicalFile\l::readBytewise" alt="" coords="651,209,792,250"/>
<area shape="rect" id="node14" href="classDevFs.html#a7975b933760278dd9bdbd0fceff87fa6" title="DevFs::initialise" alt="" coords="663,275,779,301"/>
<area shape="rect" id="node15" href="classExt2Filesystem.html#a01ee85a4315570e134649db8862790c9" title="Ext2Filesystem::createNode" alt="" coords="627,325,815,352"/>
<area shape="rect" id="node16" href="classFatFilesystem.html#a302aa4ab6a7cf1be10758d424de2b367" title="FatFilesystem::createSymlink" alt="" coords="623,376,819,403"/>
<area shape="rect" id="node17" href="classUnixSocketSyscalls.html#a894d6c12d21ffc3588847ecbed648fcc" title="UnixSocketSyscalls\l::sendto_msg" alt="" coords="651,427,791,469"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee0f83ac85871b808f2b0dcce9c55034"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::pin </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increases <code>key</code> 's <code>refcnt</code> by one.</p>
<p>This is used for places that, for example, use the physical address of a cache page and therefore will never set the dirty flag of a virtual page. This use case will need to provide its own means for writing data back to the backing store, if that is desirable.</p>
<p>Pinned pages will not be freed during a compact().</p>
<dl class="section return"><dt>Returns</dt><dd>false if key didn't exist, true otherwise </dd></dl>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00557">557</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>.</p>

<p>Referenced by <a class="el" href="File_8cc_source.html#l00242">File::getPhysicalPage()</a>, <a class="el" href="DiskImage_8cc_source.html#l00075">DiskImage::pin()</a>, and <a class="el" href="FatFile_8cc_source.html#l00072">FatFile::pinBlock()</a>.</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_aee0f83ac85871b808f2b0dcce9c55034_icgraph.png" border="0" usemap="#classCache_aee0f83ac85871b808f2b0dcce9c55034_icgraph" alt=""/></div>
<map name="classCache_aee0f83ac85871b808f2b0dcce9c55034_icgraph" id="classCache_aee0f83ac85871b808f2b0dcce9c55034_icgraph">
<area shape="rect" id="node2" href="classFile.html#a8a7c1b5ac4f646c7cb8eeb7708772228" title="File::getPhysicalPage" alt="" coords="139,5,288,32"/>
<area shape="rect" id="node4" href="classDiskImage.html#a0156cd73654e1ebc8d2b561067df37d7" title="Pins a cache page. " alt="" coords="158,56,269,83"/>
<area shape="rect" id="node8" href="classFatFile.html#a256d067710cc77aba14ad7bc5ee02168" title="FatFile::pinBlock" alt="" coords="153,107,273,133"/>
<area shape="rect" id="node3" href="classMemoryMappedFile.html#a66353cd31e469385cd9492879fd8e834" title="MemoryMappedFile::setPermissions" alt="" coords="336,5,571,32"/>
<area shape="rect" id="node5" href="classDiskImage.html#ad164622638c31b85dbe30a05f01326f8" title="Gets the block size of the disk. " alt="" coords="368,56,539,83"/>
<area shape="rect" id="node6" href="classDiskImage.html#a42765c496a07295a42a12e9db4e747e7" title="DiskImage::read" alt="" coords="619,56,737,83"/>
<area shape="rect" id="node7" href="classDiskImage.html#aca6bbf631caaaa94d8d6ca53f5261250" title="DiskImage::dump" alt="" coords="785,56,911,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f0e6f1a86035400d840b4128dc117d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::promotePage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td>
          <td class="paramname"><em>pPage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Promote the given <a class="el" href="structCache_1_1CachePage.html">CachePage</a> within the LRU list.</p>
<p>This marks the page as the most-recently-used page. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00837">837</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3a4f0916381ef6f3cd5ae0a1139e80d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::release </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decreases <code>key</code> 's <code>refcnt</code> by one. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00578">578</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="RequestQueue_8cc_source.html#l00282">RequestQueue::addAsyncRequest()</a>, <a class="el" href="assert_8h_source.html#l00037">assert</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Cache_8h_source.html#l00131">Cache::CachePage::refcnt</a>.</p>

<p>Referenced by <a class="el" href="File_8cc_source.html#l00315">File::returnPhysicalPage()</a>, <a class="el" href="DiskImage_8cc_source.html#l00080">DiskImage::unpin()</a>, and <a class="el" href="FatFile_8cc_source.html#l00077">FatFile::unpinBlock()</a>.</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_a3a4f0916381ef6f3cd5ae0a1139e80d1_icgraph.png" border="0" usemap="#classCache_a3a4f0916381ef6f3cd5ae0a1139e80d1_icgraph" alt=""/></div>
<map name="classCache_a3a4f0916381ef6f3cd5ae0a1139e80d1_icgraph" id="classCache_a3a4f0916381ef6f3cd5ae0a1139e80d1_icgraph">
<area shape="rect" id="node2" href="classFile.html#adf3b7b34a5a5e63a99da4d9a719a7a2d" title="File::returnPhysicalPage" alt="" coords="164,5,328,32"/>
<area shape="rect" id="node3" href="classDiskImage.html#acb4d50da90301cf52b6ebc858967dd37" title="DiskImage::unpin" alt="" coords="184,56,308,83"/>
<area shape="rect" id="node7" href="classFatFile.html#ad6d4ab615702c95fe1f90bed713faae4" title="FatFile::unpinBlock" alt="" coords="179,107,313,133"/>
<area shape="rect" id="node4" href="classDiskImage.html#ad164622638c31b85dbe30a05f01326f8" title="Gets the block size of the disk. " alt="" coords="376,56,547,83"/>
<area shape="rect" id="node5" href="classDiskImage.html#a42765c496a07295a42a12e9db4e747e7" title="DiskImage::read" alt="" coords="595,56,713,83"/>
<area shape="rect" id="node6" href="classDiskImage.html#aca6bbf631caaaa94d8d6ca53f5261250" title="DiskImage::dump" alt="" coords="761,56,887,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33781f985754a794f2dd19729a2d5170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::setCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCache.html#aacb3a645b9380ddd06be3d6e0245428a">Cache::writeback_t</a>&#160;</td>
          <td class="paramname"><em>newCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the write back callback to the given function. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00759">759</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>Referenced by <a class="el" href="FatFile_8cc_source.html#l00023">FatFile::FatFile()</a>.</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_a33781f985754a794f2dd19729a2d5170_icgraph.png" border="0" usemap="#classCache_a33781f985754a794f2dd19729a2d5170_icgraph" alt=""/></div>
<map name="classCache_a33781f985754a794f2dd19729a2d5170_icgraph" id="classCache_a33781f985754a794f2dd19729a2d5170_icgraph">
<area shape="rect" id="node2" href="classFatFile.html#a7f52b7be0ff4d5b74b92b678efd3146d" title="FatFile::FatFile" alt="" coords="191,5,301,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a63205a7e5c3bc8555e14a1cfd34856cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::startAtomic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enters a critical section with respect to this cache. That is, do not permit write back callbacks to be fired (aside from as a side effect of eviction) until the section has been left.</p>
<p>This is especially useful for an 'insert then read into buffer' operation, which can cause a writeback in the middle of reading (when nothing has actually changed at all). </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00283">283</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a49319c0bbb177eb08db38a2958bf5611"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::sync </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>async</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Synchronises the given cache key back to a backing store, if a callback has been assigned to the <a class="el" href="classCache.html">Cache</a>. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00625">625</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="RequestQueue_8cc_source.html#l00282">RequestQueue::addAsyncRequest()</a>, <a class="el" href="RequestQueue_8cc_source.html#l00118">RequestQueue::addRequest()</a>, <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>, and <a class="el" href="Log_8h_source.html#l00078">WARNING</a>.</p>

<p>Referenced by <a class="el" href="FatFile_8cc_source.html#l00067">FatFile::sync()</a>.</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCache_a49319c0bbb177eb08db38a2958bf5611_icgraph.png" border="0" usemap="#classCache_a49319c0bbb177eb08db38a2958bf5611_icgraph" alt=""/></div>
<map name="classCache_a49319c0bbb177eb08db38a2958bf5611_icgraph" id="classCache_a49319c0bbb177eb08db38a2958bf5611_icgraph">
<area shape="rect" id="node2" href="classFatFile.html#a8a6df02c9ef7a04ecd85b616513cac5a" title="FatFile::sync" alt="" coords="149,5,248,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5e2cbc66e8c1d8709ea556ab2c973e36"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::timer </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InterruptState &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classCache.html">Cache</a> timer handler.</p>
<p>Will call callbacks as needed to write dirty pages back to the backing store. If no callback is set for the <a class="el" href="classCache.html">Cache</a> instance, the timer will not fire. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000556">Todo:</a></b></dt><dd>something with locks </dd></dl>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00682">682</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="RequestQueue_8cc_source.html#l00282">RequestQueue::addAsyncRequest()</a>, <a class="el" href="Log_8h_source.html#l00082">ERROR</a>, <a class="el" href="Log_8h_source.html#l00136">Hex</a>, <a class="el" href="system_2include_2pedigree_2kernel_2compiler_8h_source.html#l00052">LIKELY</a>, <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>, <a class="el" href="Log_8h_source.html#l00074">NOTICE</a>, and <a class="el" href="system_2include_2pedigree_2kernel_2compiler_8h_source.html#l00054">UNLIKELY</a>.</p>

</div>
</div>
<a class="anchor" id="ab95b124344edcb2f63365a8e283e6769"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::triggerChecksum </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Triggers the cache to calculate the checksum of the given location. This may be useful to avoid a spurious writeback when reading data into a cache page for the first time. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00664">664</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>.</p>

</div>
</div>
<a class="anchor" id="a698aaab39860f6f9ecf45074e4f58059"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Cache::trim </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to trim the cache.</p>
<p>A trim is slightly different to a compact in that it is designed to be called in a non-emergency situation. This could be called, for example, after a process terminates, to clean up some old cached data while the system is already doing busywork. Or, it could be called when the system is idle to clean up a bit.</p>
<p>This will take the lock, also, unlike compact(). </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00606">606</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Process_8h_source.html#l00512">Process::m_Lock</a>.</p>

</div>
</div>
<a class="anchor" id="a3ad48828b3f2b33caf4688fbd228fcba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Cache::unlinkPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td>
          <td class="paramname"><em>pPage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unlink the given <a class="el" href="structCache_1_1CachePage.html">CachePage</a> from the LRU list. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00843">843</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8h_source.html#l00156">Cache::CachePage::pNext</a>.</p>

</div>
</div>
<a class="anchor" id="a48f1be5e296552d0779997cb6a4f4c95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Cache::verifyChecksum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&#160;</td>
          <td class="paramname"><em>pPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>replace</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verify the given <a class="el" href="structCache_1_1CachePage.html">CachePage</a>'s checksum. </p>

<p>Definition at line <a class="el" href="Cache_8cc_source.html#l00861">861</a> of file <a class="el" href="Cache_8cc_source.html">Cache.cc</a>.</p>

<p>References <a class="el" href="Cache_8cc_source.html#l00969">Cache::CachePage::checkChecksum()</a>, <a class="el" href="Cache_8h_source.html#l00134">Cache::CachePage::checksum</a>, <a class="el" href="Cache_8cc_source.html#l00974">Cache::CachePage::checkZeroChecksum()</a>, and <a class="el" href="Cache_8h_source.html#l00127">Cache::CachePage::location</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa00cf09971efce081daf9849c8e02e47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRangeList.html">MemoryAllocator</a> Cache::m_Allocator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Static MemoryAllocator to allocate virtual address space for all caches. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00403">403</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a20a40d549384db54b7270285b78805b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSpinlock.html">Spinlock</a> Cache::m_AllocatorLock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Lock for using the allocator. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00406">406</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e2244ea992c61be51e6d6d6ddeac33d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAtomic.html">Atomic</a>&lt;size_t&gt; Cache::m_bInCritical</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Are we currently in a critical section? </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00422">422</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58c82d2fa13015b57a37db5a275aa71f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCache.html#aacb3a645b9380ddd06be3d6e0245428a">writeback_t</a> Cache::m_Callback</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Callback to be called in the write-back timer handler. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00412">412</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc58a498a96ed0b3edff877d2f4ecd8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* Cache::m_CallbackMeta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Metadata to pass to a callback. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00419">419</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae1f69ced64606de12ef2c956fb1a6b81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSpinlock.html">Spinlock</a> Cache::m_Lock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Lock for this cache. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00409">409</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4a2149bc3d104f0321742c437ef4403e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t Cache::m_Nanoseconds</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classTimer.html">Timer</a> interface: number of nanoseconds counted so far in the timer handler. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00416">416</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8cd4872c514bd9aa6e3b95a50456f474"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Cache::m_PageConstraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constraints we need to apply to each page we allocate. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00425">425</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9a6db8399d5411119bc645d85b107912"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBloomFilter.html">BloomFilter</a>&lt;uintptr_t&gt; Cache::m_PageFilter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Bloom filter for lookups into m_Pages. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00393">393</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab1b7db14fa5e0b5c6beeadd3d1887172"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTree.html">Tree</a>&lt;uintptr_t, <a class="el" href="structCache_1_1CachePage.html">CachePage</a> *&gt; Cache::m_Pages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Key-item pairs. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00390">390</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9990597a441582e85d8bddaf5bcbbda3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structCache_1_1CachePage.html">CachePage</a>* Cache::m_pLruHead</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classList.html">List</a> of known CachePages, kept up-to-date with m_Pages but in LRU order. </p>

<p>Definition at line <a class="el" href="Cache_8h_source.html#l00398">398</a> of file <a class="el" href="Cache_8h_source.html">Cache.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Cache_8h_source.html">Cache.h</a></li>
<li><a class="el" href="Cache_8cc_source.html">Cache.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 24 2020 06:49:10 for The Pedigree Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
